var b=Object.defineProperty;var _=(r,e,t)=>e in r?b(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>(_(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const w="modulepreload",L=function(r){return"/"+r},v={},q=function(e,t,l){let s=Promise.resolve();if(t&&t.length>0){const n=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),p=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(t.map(o=>{if(o=L(o),o in v)return;v[o]=!0;const a=o.endsWith(".css"),g=a?'[rel="stylesheet"]':"";if(!!l)for(let u=n.length-1;u>=0;u--){const h=n[u];if(h.href===o&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${g}`))return;const d=document.createElement("link");if(d.rel=a?"stylesheet":w,a||(d.as="script",d.crossOrigin=""),d.href=o,p&&d.setAttribute("nonce",p),document.head.appendChild(d),a)return new Promise((u,h)=>{d.addEventListener("load",u),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})}))}return s.then(()=>e()).catch(n=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=n,window.dispatchEvent(i),!i.defaultPrevented)throw n})};let m;const E=async()=>{try{const e="../../salmoning.js";m=(await q(()=>import(e),[])).send_message_to_world}catch(r){console.error("salmoning.js module is not available",r),m=()=>console.log("Fallback function")}};E();class f{constructor(){c(this,"app");c(this,"money");c(this,"shop");c(this,"phone");c(this,"ques");c(this,"job");c(this,"tasks");c(this,"boundAcceptHandler");var e,t,l,s,n,i,p;document.querySelector("#app").innerHTML=`
  <div>
    <div id="money">$0</div>
    <h1 class="hidden" id="shop">SHOPPING</h1>
    <div id="phone" class="phone_down">
      <div class="screen hidden" id="choose_name">
        Enter your name:
        <input type="text" autocomplete=off id="name_input" placeholder="sam"></input>
        </div>
      <div class="screen hidden" id="job">
        <p>Someone is summoning you!</p>
        <p id="quest">"I need my groceries delivered."</p>
        <div class="flex-row">
        <button id="quest-accept" class="accept">Nice</button>
          <button id="quest-decline" class="decline">OK</button>
          </div>
        </div>
    </div>
  </div>
`,this.app=document.querySelector("#app"),this.money=(e=this.app)==null?void 0:e.querySelector("#money"),this.shop=(t=this.app)==null?void 0:t.querySelector("#shop"),this.phone=(l=this.app)==null?void 0:l.querySelector("#phone"),this.ques=(s=this.app)==null?void 0:s.querySelector("#quest"),this.job=(n=this.app)==null?void 0:n.querySelector("job"),this.boundAcceptHandler=this.acceptHandler.bind(this),this.tasks=new Set,(i=this.app)==null||i.querySelector("#quest-accept").addEventListener("click",()=>{this.accept()}),(p=this.app)==null||p.querySelector("#quest-decline").addEventListener("click",()=>{this.accept()}),this.phone.addEventListener("mousemove",o=>{var a;((a=document==null?void 0:document.activeElement)==null?void 0:a.id)==="name_input"&&o.stopPropagation()}),this.phone.addEventListener("keydown",o=>{o.target.id==="name_input"&&(o.stopPropagation(),o.key==="Enter"&&(this.remove_task("choose_name"),m({type:"ChangeName",name:o.target.value}),o.target.blur()))}),this.phone.addEventListener("keyup",o=>{o.target.id==="name_input"&&(o.stopPropagation(),console.log(o))})}sync_money(e){this.money.innerHTML=`$${e}`}add_task(e){var t;this.phone.classList.remove("phone_down"),(t=this.phone.querySelector(`#${e}`))==null||t.classList.remove("hidden"),this.tasks.add(e)}remove_task(e){var t;(t=this.phone.querySelector(`#${e}`))==null||t.classList.add("hidden"),this.tasks.delete(e),this.tasks.size||this.phone.classList.add("phone_down")}show_shop(e){e?this.shop.classList.remove("hidden"):this.shop.classList.add("hidden")}accept(){m({type:"AcceptQuest"}),document.removeEventListener("keydown",this.boundAcceptHandler),this.remove_task("job")}acceptHandler(e){console.log(e),e.key==="e"&&(e.stopPropagation(),console.log("Accepted!"),this.accept())}quest(e){this.add_task("job"),this.ques.innerHTML=`"${e}"`,document.addEventListener("keydown",this.boundAcceptHandler)}}let y;window.bridge_init=()=>{y=new f};Object.getOwnPropertyNames(f.prototype).forEach(r=>{window[`bridge_${r}`]=function(){return y&&f.prototype[r].apply(y,arguments)}});
